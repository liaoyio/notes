import{_ as s,i as n,h as a,O as l}from"./chunks/framework.9399b50c.js";const e="/notes/assets/InersectionObserverAPI.c75f35d7.png",p="/notes/assets/intersectionRatio.bb90a9d0.png",o="/notes/assets/MutationObserverAPI.1c9e315f.png",t="/notes/assets/MutationEventAPI.41842be7.png",r="/notes/assets/update-dom-attr.2b11e0d3.png",c="/notes/assets/add-child-node.9af243f0.png",i="/notes/assets/remove-child-node.96fd5e20.png",y="/notes/assets/ResizeObserverAPI.ed01de62.png",D="/notes/assets/resize-change.2c18199a.png",F="/notes/assets/mark.4aa52b70.png",d="/notes/assets/resource.3473f040.png",b="/notes/assets/measure.107f542f.png",O=JSON.parse('{"title":"æµè§ˆå™¨è§‚å¯Ÿè€… Observer API","description":"","frontmatter":{"title":"æµè§ˆå™¨è§‚å¯Ÿè€… Observer API"},"headers":[],"relativePath":"basic/js/api/observer_api.md","lastUpdated":1696236510000}'),B={name:"basic/js/api/observer_api.md"},u=l('<h1 id="æµè§ˆå™¨è§‚å¯Ÿè€…-observer-api" tabindex="-1">æµè§ˆå™¨è§‚å¯Ÿè€… Observer API <a class="header-anchor" href="#æµè§ˆå™¨è§‚å¯Ÿè€…-observer-api" aria-label="Permalink to &quot;æµè§ˆå™¨è§‚å¯Ÿè€… Observer API&quot;">â€‹</a></h1><details class="details custom-block"><summary>Details</summary><nav class="table-of-contents"><ul><li><a href="#æ€»ä½“å¯¹æ¯”">æ€»ä½“å¯¹æ¯”</a></li><li><a href="#intersection-observer-äº¤å‰è§‚å¯Ÿè€…">Intersection Observer,äº¤å‰è§‚å¯Ÿè€…</a><ul><li><a href="#æµè§ˆå™¨å…¼å®¹æ€§">æµè§ˆå™¨å…¼å®¹æ€§</a></li><li><a href="#è¯­æ³•">è¯­æ³•</a></li><li><a href="#polyfill">polyfill</a></li><li><a href="#ç¤ºä¾‹">ç¤ºä¾‹</a></li></ul></li><li><a href="#mutation-observer-å˜åŠ¨è§‚å¯Ÿè€…">Mutation Observer,å˜åŠ¨è§‚å¯Ÿè€…</a><ul><li><a href="#å…¼å®¹æ€§">å…¼å®¹æ€§</a></li><li><a href="#è¯­æ³•-1">è¯­æ³•</a></li><li><a href="#polyfill-1">polyfill</a></li><li><a href="#ç¤ºä¾‹-1">ç¤ºä¾‹</a></li></ul></li><li><a href="#resize-observer-å°ºå¯¸è§‚å¯Ÿè€…">Resize Observer,å°ºå¯¸è§‚å¯Ÿè€…</a><ul><li><a href="#æµè§ˆå™¨å…¼å®¹æ€§-1">æµè§ˆå™¨å…¼å®¹æ€§</a></li><li><a href="#è¯­æ³•-2">è¯­æ³•</a></li><li><a href="#polyfill-2">polyfill</a></li><li><a href="#ç¤ºä¾‹-2">ç¤ºä¾‹</a></li></ul></li><li><a href="#performance-observer-æ€§èƒ½è§‚å¯Ÿè€…">Performance Observer,æ€§èƒ½è§‚å¯Ÿè€…</a><ul><li><a href="#mark">mark</a></li><li><a href="#resource">resource</a></li><li><a href="#measure">measure</a></li></ul></li></ul></nav></details><h2 id="æ€»ä½“å¯¹æ¯”" tabindex="-1">æ€»ä½“å¯¹æ¯” <a class="header-anchor" href="#æ€»ä½“å¯¹æ¯”" aria-label="Permalink to &quot;æ€»ä½“å¯¹æ¯”&quot;">â€‹</a></h2><table><thead><tr><th style="text-align:left;"></th><th style="text-align:left;">IntersectionObserver</th><th style="text-align:left;">MutationObserver</th><th style="text-align:left;">ResizeObserver</th><th style="text-align:left;">PerformanceObserver</th></tr></thead><tbody><tr><td style="text-align:left;">ç”¨é€”</td><td style="text-align:left;">è§‚å¯Ÿä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨è§†çª—å¯è§</td><td style="text-align:left;">è§‚å¯Ÿ DOM ä¸­çš„å˜åŒ–</td><td style="text-align:left;">è§‚å¯Ÿè§†å£å¤§å°çš„å˜åŒ–</td><td style="text-align:left;">ç›‘æµ‹æ€§èƒ½åº¦é‡äº‹ä»¶</td></tr><tr><td style="text-align:left;">æ–¹æ³•</td><td style="text-align:left;"><code>observe()</code> <br> <code>disconnect()</code> <br> <code>takeRecords()</code></td><td style="text-align:left;"><code>observe()</code> <br> <code>disconnect()</code> <br> <code>takeRecords()</code> <br> <code>unobserve()</code></td><td style="text-align:left;"><code>observe()</code> <br> <code>disconnect()</code> <br> <code>unobserve()</code></td><td style="text-align:left;"><code>observe()</code> <br> <code>disconnect()</code> <br> <code>takeRecords()</code></td></tr><tr><td style="text-align:left;">å–ä»£</td><td style="text-align:left;">Dom Mutation events</td><td style="text-align:left;"><code>getBoundingClientRect()</code> è¿”å›å…ƒç´ çš„å¤§å°åŠå…¶ç›¸å¯¹äºå¯è§†çª—å£çš„ä½ç½®,<code>Scroll</code> å’Œ <code>Resize</code> äº‹ä»¶</td><td style="text-align:left;"><code>Resize</code> äº‹ä»¶</td><td style="text-align:left;"><code>Performance</code> æ¥å£</td></tr><tr><td style="text-align:left;">ç”¨é€”</td><td style="text-align:left;">1. æ— é™æ»šåŠ¨ <br> 2. å›¾ç‰‡æ‡’åŠ è½½ <br> 3. å…´è¶£åŸ‹ç‚¹ <br> 4. æ§åˆ¶åŠ¨ç”»/è§†é¢‘æ‰§è¡Œï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰</td><td style="text-align:left;">1. æ›´é«˜æ€§èƒ½çš„æ•°æ®ç»‘å®šåŠå“åº” <br> 2. å®ç°è§†è§‰å·®æ»šåŠ¨ <br> 3. å›¾ç‰‡é¢„åŠ è½½ <br> 4. å®ç°å¯Œæ–‡æœ¬ç¼–è¾‘å™¨</td><td style="text-align:left;">1. æ›´æ™ºèƒ½çš„å“åº”å¼å¸ƒå±€ï¼ˆå–ä»£@mediaï¼‰<br> 2. å“åº”å¼ç»„ä»¶</td><td style="text-align:left;">1. æ›´ç»†é¢—ç²’çš„æ€§èƒ½ç›‘æ§ <br> 2. åˆ†ææ€§èƒ½å¯¹ä¸šåŠ¡çš„å½±å“ï¼ˆäº¤äº’å¿«/æ…¢æ˜¯å¦ä¼šå½±å“é”€é‡ï¼‰</td></tr></tbody></table><h2 id="intersection-observer-äº¤å‰è§‚å¯Ÿè€…" tabindex="-1">Intersection Observer,äº¤å‰è§‚å¯Ÿè€… <a class="header-anchor" href="#intersection-observer-äº¤å‰è§‚å¯Ÿè€…" aria-label="Permalink to &quot;Intersection Observer,äº¤å‰è§‚å¯Ÿè€…&quot;">â€‹</a></h2><p><code>IntersectionObserver</code> å¯ä»¥ç›‘å¬ä¸€ä¸ªå…ƒç´ å’Œå¯è§†åŒºåŸŸç›¸äº¤éƒ¨åˆ†çš„æ¯”ä¾‹,ç„¶ååœ¨å¯è§†æ¯”ä¾‹è¾¾åˆ°æŸä¸ªé˜ˆå€¼çš„æ—¶å€™è§¦å‘å›è°ƒã€‚</p><h3 id="æµè§ˆå™¨å…¼å®¹æ€§" tabindex="-1">æµè§ˆå™¨å…¼å®¹æ€§ <a class="header-anchor" href="#æµè§ˆå™¨å…¼å®¹æ€§" aria-label="Permalink to &quot;æµè§ˆå™¨å…¼å®¹æ€§&quot;">â€‹</a></h3><p><img src="'+e+`" alt=""></p><h3 id="è¯­æ³•" tabindex="-1">è¯­æ³• <a class="header-anchor" href="#è¯­æ³•" aria-label="Permalink to &quot;è¯­æ³•&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#BABED8;"> observer </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">IntersectionObserver</span><span style="color:#BABED8;">(callback[</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title"><code>callback</code> æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°,é‡Œé¢è¿”å›ç›‘å¬ç›®æ ‡å…ƒç´ çš„å®æ—¶æ•°æ®ç»„æˆçš„æ•°ç»„</p><ul><li><code>time</code> æ—¶é—´æˆ³</li><li><code>rootBounds</code> æ ¹å…ƒç´ çš„ä½ç½®ä¿¡æ¯</li><li><code>boundingClientRect</code> ç›®æ ‡å…ƒç´ çš„ä½ç½®ä¿¡æ¯</li><li><code>intersectionRect</code> äº¤å‰éƒ¨åˆ†çš„ä½ç½®ä¿¡æ¯</li><li><code>intersectionRatio</code> ç›®æ ‡å…ƒç´ çš„å¯è§æ¯”ä¾‹,çœ‹ä¸‹å›¾ç¤º</li><li><code>target</code> ç­‰</li></ul></div><div class="tip custom-block"><p class="custom-block-title"><code>options</code> æ˜¯ä¸€äº›é…ç½®</p><ul><li><code>root</code> ç›®æ ‡å…ƒç´ çš„ç¥–å…ˆå…ƒç´ ,å³è¯¥å…ƒç´ å¿…é¡»æ˜¯ç›®æ ‡å…ƒç´ çš„ç›´æ¥æˆ–é—´æ¥çˆ¶çº§</li><li><code>rootMargin</code> ä¸€ä¸ªåœ¨è®¡ç®—äº¤å‰å€¼æ—¶æ·»åŠ è‡³ <code>root</code> çš„è¾¹ç•Œç›’ä¸­çš„ä¸€ç»„åç§»é‡,å†™æ³•ç±»ä¼¼ <code>CSS</code> çš„ <code>margin</code></li><li><code>threshold</code> è§„å®šäº†ä¸€ä¸ªç›‘å¬ç›®æ ‡ä¸è¾¹ç•Œç›’äº¤å‰åŒºåŸŸçš„æ¯”ä¾‹å€¼,å¯ä»¥æ˜¯ä¸€ä¸ªå…·ä½“çš„æ•°å€¼æˆ–æ˜¯ä¸€ç»„ <code>0.0</code>åˆ° <code>1.0</code> ä¹‹é—´çš„æ•°ç»„</li></ul></div><p><img src="`+p+`" alt=""></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><strong>å¼€å§‹ç›‘å¬å…ƒç´ :</strong> <code>observer.observe(target)</code></p><p><strong>åœæ­¢å¯¹æŸç›®æ ‡çš„ç›‘å¬:</strong> <code>observer.unobserve(target)</code></p><p><strong>ç»ˆæ­¢å¯¹æ‰€æœ‰ç›®æ ‡çš„ç›‘å¬:</strong> <code>observer.disconnect()</code></p></div><h3 id="polyfill" tabindex="-1">polyfill <a class="header-anchor" href="#polyfill" aria-label="Permalink to &quot;polyfill&quot;">â€‹</a></h3><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pnpm</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">add</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">intersection-observer</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ä½¿ç”¨</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># å…¥å£æ–‡ä»¶å¼•å…¥å³å¯</span></span>
<span class="line"><span style="color:#FFCB6B;">import</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">intersection-observer</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="ç¤ºä¾‹" tabindex="-1">ç¤ºä¾‹ <a class="header-anchor" href="#ç¤ºä¾‹" aria-label="Permalink to &quot;ç¤ºä¾‹&quot;">â€‹</a></h3><div class="language-vue line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">setup</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> intersectionObserver </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">IntersectionObserver</span><span style="color:#BABED8;">(</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">entries</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">info:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">entries</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">item</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">item</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">target</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">item</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">intersectionRatio</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">threshold</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> [</span><span style="color:#F78C6C;">0.5</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">box1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    BOX111</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">box2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    BOX222</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">#</span><span style="color:#F78C6C;">box1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">#</span><span style="color:#F78C6C;">box2</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">100px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">100px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">background</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> blue</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">color</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">#</span><span style="color:#BABED8;">fff</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">position</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> relative</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">#</span><span style="color:#F78C6C;">box1</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">top</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">500px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">#</span><span style="color:#F78C6C;">box2</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">top</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">800px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>åˆ›å»ºä¸€ä¸ª <code>IntersectionObserver</code> å¯¹è±¡,ç›‘å¬ <code>box1</code> å’Œ <code>box2</code> ä¸¤ä¸ªå…ƒç´ ,å½“å¯è§æ¯”ä¾‹è¾¾åˆ°<code> 0.5</code> å’Œ <code>1</code> çš„æ—¶å€™è§¦å‘å›è°ƒã€‚</p><p>å¯ä»¥çœ‹åˆ°å…ƒç´  <code>box1</code> å’Œ <code>box2</code> åœ¨å¯è§†èŒƒå›´è¾¾åˆ°ä¸€åŠï¼ˆ<code>0.5</code>ï¼‰å’Œå…¨éƒ¨ï¼ˆ<code>1</code>ï¼‰çš„æ—¶å€™åˆ†åˆ«è§¦å‘äº†å›è°ƒã€‚</p><p>æ•°æ®é‡‡é›†çš„æ—¶å€™,å¸Œæœ›çŸ¥é“æŸä¸ªå…ƒç´ æ˜¯å¦æ˜¯å¯è§çš„,ä»€ä¹ˆæ—¶å€™å¯è§çš„,å°±å¯ä»¥ç”¨è¿™ä¸ª api æ¥ç›‘å¬,è¿˜æœ‰åšå›¾ç‰‡çš„æ‡’åŠ è½½çš„æ—¶å€™,å¯ä»¥å½“å¯è§†æ¯”ä¾‹è¾¾åˆ°æŸä¸ªæ¯”ä¾‹å†è§¦å‘åŠ è½½ã€‚</p><h2 id="mutation-observer-å˜åŠ¨è§‚å¯Ÿè€…" tabindex="-1">Mutation Observer,å˜åŠ¨è§‚å¯Ÿè€… <a class="header-anchor" href="#mutation-observer-å˜åŠ¨è§‚å¯Ÿè€…" aria-label="Permalink to &quot;Mutation Observer,å˜åŠ¨è§‚å¯Ÿè€…&quot;">â€‹</a></h2><p><code>MutationObserver</code> å¯ä»¥ç›‘å¬å¯¹å…ƒç´ çš„å±æ€§çš„ä¿®æ”¹ã€å¯¹å®ƒçš„å­èŠ‚ç‚¹çš„å¢åˆ æ”¹ã€‚</p><h3 id="å…¼å®¹æ€§" tabindex="-1">å…¼å®¹æ€§ <a class="header-anchor" href="#å…¼å®¹æ€§" aria-label="Permalink to &quot;å…¼å®¹æ€§&quot;">â€‹</a></h3><p><img src="`+o+`" alt=""></p><h3 id="è¯­æ³•-1" tabindex="-1">è¯­æ³• <a class="header-anchor" href="#è¯­æ³•-1" aria-label="Permalink to &quot;è¯­æ³•&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> observer </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MutationObserver</span><span style="color:#BABED8;">(callback)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>å¼€å§‹ç›‘å¬</strong></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">observer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">observe</span><span style="color:#BABED8;">(target</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> config)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title"><code>config</code> å¡«å†™éœ€è¦ç›‘å¬å±æ€§</p><ul><li>attributes å¸ƒå°”ç±»å‹ å±æ€§çš„å˜åŠ¨</li><li>childList å¸ƒå°”ç±»å‹ å­èŠ‚ç‚¹çš„å˜åŠ¨ï¼ˆæŒ‡æ–°å¢,åˆ é™¤æˆ–è€…æ›´æ”¹ï¼‰</li><li>characterData å¸ƒå°”ç±»å‹ èŠ‚ç‚¹å†…å®¹æˆ–èŠ‚ç‚¹æ–‡æœ¬çš„å˜åŠ¨ã€‚</li><li>subtree å¸ƒå°”ç±»å‹ æ˜¯å¦å°†è¯¥è§‚å¯Ÿå™¨åº”ç”¨äºè¯¥èŠ‚ç‚¹çš„æ‰€æœ‰åä»£èŠ‚ç‚¹</li><li>attributeOldValue å¸ƒå°”ç±»å‹ è§‚å¯Ÿ attributes å˜åŠ¨æ—¶,æ˜¯å¦éœ€è¦è®°å½•å˜åŠ¨å‰çš„å±æ€§å€¼</li><li>characterDataOldValue å¸ƒå°”ç±»å‹ è§‚å¯Ÿ characterData å˜åŠ¨æ—¶,æ˜¯å¦éœ€è¦è®°å½•å˜åŠ¨å‰çš„å€¼</li><li>attributeFilter æ•°ç»„ éœ€è¦è§‚å¯Ÿçš„ç‰¹å®šå±æ€§ï¼ˆæ¯”å¦‚[&#39;class&#39;,&#39;src&#39;]ï¼‰</li></ul></div><p>ğŸ”œ <strong>ç»ˆæ­¢å¯¹æ‰€æœ‰ç›®æ ‡çš„ç›‘å¬:</strong> <code>observer.disconnect()</code></p><p><strong>takeRecords():</strong> ä» <code>MutationObserver</code> çš„é€šçŸ¥é˜Ÿåˆ—ä¸­åˆ é™¤æ‰€æœ‰å¾…å¤„ç†çš„é€šçŸ¥,å¹¶å°†å®ƒä»¬è¿”å›åˆ° <code>MutationRecord</code> å¯¹è±¡çš„æ–° <code>Array</code> ä¸­ã€‚</p><h3 id="polyfill-1" tabindex="-1">polyfill <a class="header-anchor" href="#polyfill-1" aria-label="Permalink to &quot;polyfill&quot;">â€‹</a></h3><p>å¦‚æœä½ çš„æµè§ˆå™¨ä¸éœ€è¦å…¼å®¹ <code>IE9</code>,<code>IE10</code> æµè§ˆå™¨,æ¨èä½¿ç”¨ <code>MutationObserver</code> å®ç° <code>DOM</code> å˜åŒ–çš„æ£€æµ‹ã€‚</p><p>å¦‚æœä½ çš„é¡¹ç›®éœ€è¦å…¼å®¹ <code>IE9</code>,<code>IE10</code> æµè§ˆå™¨,åŒæ—¶æƒ³è¦å®ç°å¯¹ <code>DOM</code> å˜åŒ–çš„æ£€æµ‹,åˆ™å¯ä»¥è¯•è¯• <code>Mutation events</code>ã€‚</p><p><img src="`+t+`" alt=""></p><p><code>Mutation events</code> è¯­æ³•ä¸Šç›¸å¯¹ç®€å•æ˜“æ‡‚å¾ˆå¤š, ä½ å°±è®¤ä¸ºæ˜¯å’Œ&#39;<code>click</code>&#39;, &#39;<code>mouseover</code>&#39;ä¸€æ ·çš„ DOM äº‹ä»¶ç”¨å°±å¥½äº†ã€‚</p><div class="tip custom-block"><p class="custom-block-title">æ”¯æŒçš„äº‹ä»¶åˆ—è¡¨å¦‚ä¸‹:</p><ul><li><code>DOMAttrModified</code> (Chrome/Safari ä¸æ”¯æŒ)</li><li><code>DOMAttributeNameChanged</code></li><li><code>DOMCharacterDataModified</code></li><li><code>DOMElementNameChanged</code></li><li><code>DOMNodeInserted</code></li><li><code>DOMNodeInsertedIntoDocument</code> (IE ä¸æ”¯æŒ)</li><li><code>DOMNodeRemoved</code></li><li><code>DOMNodeRemovedFromDocument</code> (IE ä¸æ”¯æŒ)</li><li><code>DOMSubtreeModified</code></li></ul></div><p>å…·ä½“æè¿°è§ä¸‹è¡¨ï¼ˆIE ä¸æ”¯æŒçš„ä¸¤ä¸ªæˆ‘ä»¬å¿½ç•¥,è¿™ä¸ªå°±ç®—æ²¡å…¼å®¹æ€§é—®é¢˜å’Œå¾ˆå°‘ç”¨åˆ°ï¼‰:</p><table><thead><tr><th style="text-align:left;">äº‹ä»¶åç§°</th><th style="text-align:left;">äº‹ä»¶æè¿°</th></tr></thead><tbody><tr><td style="text-align:left;"><code>DOMAttrModified</code></td><td style="text-align:left;">DOM å±æ€§å‘ç”Ÿä¿®æ”¹</td></tr><tr><td style="text-align:left;"><code>DOMAttributeNameChanged</code></td><td style="text-align:left;">DOM å±æ€§åå‘ç”Ÿå˜åŒ–</td></tr><tr><td style="text-align:left;"><code>DOMCharacterDataModified</code></td><td style="text-align:left;">DOM æ–‡æœ¬æ•°æ®å‘ç”Ÿä¿®æ”¹</td></tr><tr><td style="text-align:left;"><code>DOMElementNameChanged</code></td><td style="text-align:left;">DOM å…ƒç´ åå‘ç”Ÿå˜åŒ–</td></tr><tr><td style="text-align:left;"><code>DOMNodeInserted</code></td><td style="text-align:left;">DOM èŠ‚ç‚¹æ’å…¥</td></tr><tr><td style="text-align:left;"><code>DOMNodeRemoved</code></td><td style="text-align:left;">DOM èŠ‚ç‚¹åˆ é™¤</td></tr><tr><td style="text-align:left;"><code>DOMSubtreeModified</code></td><td style="text-align:left;">DOM å­å…ƒç´ ä¿®æ”¹</td></tr></tbody></table><p>ä½¿ç”¨ä¾‹å­:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">element</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#BABED8;">(</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">DOMNodeInserted</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">event</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// event.targetå°±æ˜¯ä¾æ¬¡æ’å…¥çš„DOMèŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#FF9CAC;">false</span></span>
<span class="line"><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>Chrome/Safari ä¸æ”¯æŒ DOMAttrModified çš„å¤„ç†</strong></p><p><code>Object.defineProperty</code>,å¯ä»¥æ–¹ä¾¿å¯¹è‡ªå®šä¹‰å±æ€§çš„å˜åŒ–è¿›è¡Œæ£€æµ‹ã€‚</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// é‡æ–°å®šä¹‰rowså±æ€§</span></span>
<span class="line"><span style="color:#BABED8;">Object</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">defineProperty</span><span style="color:#BABED8;">(ell</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rows</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">writeable</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">enumerable</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">get</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">getAttribute</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rows</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">set</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">rows</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setAttribute</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rows</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">rows</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// rowså˜åŒ–äº†,é‡æ¸²æŸ“</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">render</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><code>Object.defineProperty </code>è¯­æ³•å¦‚ä¸‹:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">Object</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">defineProperty</span><span style="color:#BABED8;">(obj</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> prop</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> descriptor)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="ç¤ºä¾‹-1" tabindex="-1">ç¤ºä¾‹ <a class="header-anchor" href="#ç¤ºä¾‹-1" aria-label="Permalink to &quot;ç¤ºä¾‹&quot;">â€‹</a></h3><div class="language-vue line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">setup</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#82AAFF;">setTimeout</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">box</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">style</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">background</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">red</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">2000</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">setTimeout</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">dom</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createElement</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">button</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">dom</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">textContent</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ä¸œä¸œä¸œ</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">box</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">appendChild</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">dom</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">setTimeout</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelectorAll</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">button</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)[</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">remove</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">5000</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">onMounted</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">mutationObserver</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">MutationObserver</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">mutationsList</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">mutationsList</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">mutationObserver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">observe</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">box</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    attributes</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    childList</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">box</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">å…‰</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">#</span><span style="color:#F78C6C;">box</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">100px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">100px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">background</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> blue</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">position</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> relative</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>2s çš„æ—¶å€™ä¿®æ”¹èƒŒæ™¯é¢œè‰²ä¸ºçº¢è‰²,3s çš„æ—¶å€™æ·»åŠ ä¸€ä¸ª button çš„å­å…ƒç´ ,5s çš„æ—¶å€™åˆ é™¤ç¬¬ä¸€ä¸ª buttonã€‚</p><p>ç¬¬ä¸€æ¬¡æ”¹å˜çš„æ˜¯ <code>attributes</code>,å±æ€§æ˜¯ <code>style</code>:</p><p><img src="`+r+'" alt=""></p><p>ç¬¬äºŒæ¬¡æ”¹å˜çš„æ˜¯ <code>childList</code>,æ·»åŠ äº†ä¸€ä¸ªèŠ‚ç‚¹:</p><p><img src="'+c+'" alt=""></p><p>ç¬¬ä¸‰æ¬¡ä¹Ÿæ˜¯æ”¹å˜çš„ <code>childList</code>,åˆ é™¤äº†ä¸€ä¸ªèŠ‚ç‚¹:</p><p><img src="'+i+'" alt=""></p><p>æ¯”å¦‚æ–‡ç« æ°´å°è¢«äººé€šè¿‡ <code>devtools</code> å»æ‰äº†,é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ <code>MutationObserver</code> ç›‘å¬è¿™ä¸ªå˜åŒ–,ç„¶åé‡æ–°åŠ ä¸Š,è®©æ°´å°å»ä¸æ‰ã€‚</p><h2 id="resize-observer-å°ºå¯¸è§‚å¯Ÿè€…" tabindex="-1">Resize Observer,å°ºå¯¸è§‚å¯Ÿè€… <a class="header-anchor" href="#resize-observer-å°ºå¯¸è§‚å¯Ÿè€…" aria-label="Permalink to &quot;Resize Observer,å°ºå¯¸è§‚å¯Ÿè€…&quot;">â€‹</a></h2><p>å…ƒç´ å¯ä»¥ç”¨ <code>ResizeObserver</code> ç›‘å¬å¤§å°çš„æ”¹å˜,å½“ <code>width</code>ã€<code>height</code> è¢«ä¿®æ”¹æ—¶ä¼šè§¦å‘å›è°ƒã€‚</p><h3 id="æµè§ˆå™¨å…¼å®¹æ€§-1" tabindex="-1">æµè§ˆå™¨å…¼å®¹æ€§ <a class="header-anchor" href="#æµè§ˆå™¨å…¼å®¹æ€§-1" aria-label="Permalink to &quot;æµè§ˆå™¨å…¼å®¹æ€§&quot;">â€‹</a></h3><p><img src="'+y+`" alt=""></p><h3 id="è¯­æ³•-2" tabindex="-1">è¯­æ³• <a class="header-anchor" href="#è¯­æ³•-2" aria-label="Permalink to &quot;è¯­æ³•&quot;">â€‹</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> observer </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">ResizeObserver</span><span style="color:#BABED8;">(callback)</span></span>
<span class="line"><span style="color:#BABED8;">observer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">observe</span><span style="color:#BABED8;">(target)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>å¼€å§‹ç›‘å¬å…ƒç´ :</strong> <code>observer.observe(target)</code></p><p><strong>åœæ­¢å¯¹æŸç›®æ ‡çš„ç›‘å¬:</strong> <code>observer.unobserve(target)</code></p><p><strong>ç»ˆæ­¢å¯¹æ‰€æœ‰ç›®æ ‡çš„ç›‘å¬:</strong> <code>observer.disconnect()</code></p><p>è§¦å‘å›è°ƒåçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª <code>ResizeObserverEntry</code> å¯¹è±¡ã€‚è¿™é‡Œçš„ <code>entry.target</code> æ˜¯ <code>DOM</code> èŠ‚ç‚¹æœ¬èº«,è€Œ <code>entry.contentRect</code> æ˜¯ä¸€ä¸ªå¯¹è±¡,åŒ…å«äº†èŠ‚ç‚¹çš„ä½ç½®å±æ€§,å¦‚ <code>width</code>ã€<code>height</code>ã€<code>left</code>ã€<code>right</code>ã€<code>bottom</code>ã€<code>left</code>ã€<code>x</code>ã€<code>y</code> ç­‰ã€‚</p><ul><li><code>width</code>: æŒ‡å…ƒç´ æœ¬èº«çš„å®½åº¦,ä¸åŒ…å« padding, border å€¼</li><li><code>height</code>: æŒ‡å…ƒç´ æœ¬èº«çš„é«˜åº¦,ä¸åŒ…å« padding, border å€¼</li><li><code>top</code>: æŒ‡ <code>padidng-top</code> çš„å€¼</li><li><code>left</code>: æŒ‡ <code>padding-left</code> çš„å€¼</li><li><code>right</code>: æŒ‡ <code>left</code> + <code>width</code> çš„å€¼</li><li><code>bottom</code>: å€¼ <code>top</code> + <code>height</code> çš„å€¼</li><li><code>x</code>: å¤§å°ä¸ <code>top</code> ç›¸åŒ</li><li><code>y</code>: å¤§å°ä¸ <code>left</code> ç›¸åŒ</li></ul><h3 id="polyfill-2" tabindex="-1">polyfill <a class="header-anchor" href="#polyfill-2" aria-label="Permalink to &quot;polyfill&quot;">â€‹</a></h3><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">pnpm add resize-observer-polyfill</span></span>
<span class="line"><span style="color:#babed8;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> ResizeObserver </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resize-observer-polyfill</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> ro </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">ResizeObserver</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">entries</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">observer</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">entry</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">of</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">entries</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">left</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">top</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">width</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">height</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">entry</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">contentRect</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Element:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">entry</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">target</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">Element&#39;s size: </span><span style="color:#89DDFF;">\${</span><span style="color:#BABED8;">width</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">px x </span><span style="color:#89DDFF;">\${</span><span style="color:#BABED8;">height</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">px</span><span style="color:#89DDFF;">\`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">Element&#39;s paddings: </span><span style="color:#89DDFF;">\${</span><span style="color:#BABED8;">top</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">px ; </span><span style="color:#89DDFF;">\${</span><span style="color:#BABED8;">left</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">px</span><span style="color:#89DDFF;">\`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">ro</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">observe</span><span style="color:#BABED8;">(document</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">body)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="ç¤ºä¾‹-2" tabindex="-1">ç¤ºä¾‹ <a class="header-anchor" href="#ç¤ºä¾‹-2" aria-label="Permalink to &quot;ç¤ºä¾‹&quot;">â€‹</a></h3><div class="language-vue line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">setup</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#82AAFF;">onMounted</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">box</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelector</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#box</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">resizeObserver</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">ResizeObserver</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">entries</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å½“å‰å¤§å°</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#BABED8;">entries</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#BABED8;">resizeObserver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">observe</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">box</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">setTimeout</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#BABED8;">box</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">style</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">width</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">200px</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">box</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">#</span><span style="color:#F78C6C;">box</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">width</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">100px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">100px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#B2CCD6;">background</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> blue</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>å¤§å°å˜åŒ–è¢«ç›‘å¬åˆ°äº†,çœ‹ä¸‹æ‰“å°çš„ä¿¡æ¯</p><p><img src="`+D+`" alt=""></p><p>å¯ä»¥æ‹¿åˆ°å…ƒç´ å’Œå®ƒçš„ä½ç½®ã€å°ºå¯¸ã€‚</p><h2 id="performance-observer-æ€§èƒ½è§‚å¯Ÿè€…" tabindex="-1">Performance Observer,æ€§èƒ½è§‚å¯Ÿè€… <a class="header-anchor" href="#performance-observer-æ€§èƒ½è§‚å¯Ÿè€…" aria-label="Permalink to &quot;Performance Observer,æ€§èƒ½è§‚å¯Ÿè€…&quot;">â€‹</a></h2><p><code>PerformanceObserver</code> ç”¨äºç›‘å¬è®°å½• <code>performance</code> æ•°æ®çš„è¡Œä¸º, ä¸€æ—¦è®°å½•äº†å°±ä¼šè§¦å‘å›è°ƒ, è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨å›è°ƒé‡ŒæŠŠè¿™äº›æ•°æ®ä¸ŠæŠ¥ã€‚</p><p>æ¯”å¦‚ <code>performance</code> å¯ä»¥ç”¨ <code>mark</code> æ–¹æ³•è®°å½•æŸä¸ªæ—¶é—´ç‚¹:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">performance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mark</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">registered-observer</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>ç”¨ measure æ–¹æ³•è®°å½•æŸä¸ªæ—¶é—´æ®µ:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">performance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">measure</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">button clicked</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">from</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">to</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>åä¸¤ä¸ªä¸ªå‚æ•°æ˜¯æ—¶é—´ç‚¹,ä¸ä¼ ä»£è¡¨ä»å¼€å§‹åˆ°ç°åœ¨ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨ <code>PerformanceObserver</code> ç›‘å¬å®ƒä»¬:</p><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">html</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">body</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">onclick</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#82AAFF;">measureClick</span><span style="color:#C3E88D;">()</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">Measure</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">img</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://p9-passport.byteacctimg.com/img/user-avatar/4e9e751e2b32fb8afbbf559a296ccbf2~300x300.image</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    &lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#C792EA;">const</span><span style="color:#BABED8;"> performanceObserver </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">new</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">PerformanceObserver</span><span style="color:#BABED8;">(</span><span style="color:#BABED8;font-style:italic;">list</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#BABED8;">list</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getEntries</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#F07178;">(</span><span style="color:#BABED8;font-style:italic;">entry</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">entry</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// ä¸ŠæŠ¥</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;">      performanceObserver</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">observe</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">{</span><span style="color:#BABED8;"> </span><span style="color:#F07178;">entryTypes</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">resource</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mark</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">measure</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">] </span><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">      performance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mark</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">registered-observer</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">measureClick</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#BABED8;">performance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">measure</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">button clicked</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">body</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">html</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>åˆ›å»º <code>PerformanceObserver</code> å¯¹è±¡,ç›‘å¬ <code>mark</code>ï¼ˆæ—¶é—´ç‚¹ï¼‰ã€<code>measure</code>ï¼ˆæ—¶é—´æ®µï¼‰ã€<code>resource</code>ï¼ˆèµ„æºåŠ è½½è€—æ—¶ï¼‰ è¿™ä¸‰ç§è®°å½•æ—¶é—´çš„è¡Œä¸ºã€‚</p><p>ç„¶åæˆ‘ä»¬ç”¨ <code>mark</code> è®°å½•äº†æŸä¸ªæ—¶é—´ç‚¹,ç‚¹å‡» <code>button</code> çš„æ—¶å€™ç”¨ <code>measure</code> è®°å½•äº†æŸä¸ªæ—¶é—´æ®µçš„æ•°æ®,è¿˜åŠ è½½äº†ä¸€ä¸ªå›¾ç‰‡ã€‚</p><p>å½“è¿™äº›è®°å½•è¡Œä¸ºå‘ç”Ÿçš„æ—¶å€™,å¸Œæœ›èƒ½è§¦å‘å›è°ƒ,åœ¨é‡Œé¢å¯ä»¥ä¸ŠæŠ¥ã€‚</p><h3 id="mark" tabindex="-1">mark <a class="header-anchor" href="#mark" aria-label="Permalink to &quot;mark&quot;">â€‹</a></h3><p><img src="`+F+'" alt=""></p><h3 id="resource" tabindex="-1">resource <a class="header-anchor" href="#resource" aria-label="Permalink to &quot;resource&quot;">â€‹</a></h3><p><img src="'+d+'" alt=""></p><h3 id="measure" tabindex="-1">measure <a class="header-anchor" href="#measure" aria-label="Permalink to &quot;measure&quot;">â€‹</a></h3><p><img src="'+b+'" alt=""></p><div class="tip custom-block"><p class="custom-block-title">å‚è€ƒèµ„æ–™</p><p><a href="https://juejin.cn/post/7064557881492209678#heading-0" target="_blank" rel="noreferrer">æµè§ˆå™¨çš„ 5 ç§ Observer,ä½ ç”¨è¿‡å‡ ç§ï¼Ÿ</a></p><p><a href="https://juejin.cn/post/6844903976937209863" target="_blank" rel="noreferrer">ç°ä»£æµè§ˆå™¨è§‚å¯Ÿè€… Observer API æŒ‡å—</a></p><p><a href="https://xiaotianxia.github.io/blog/vuepress/js/four_kinds_of_observers.html" target="_blank" rel="noreferrer">JS ä¸­çš„è§‚å¯Ÿè€…ä»¬ â€”â€” å››ç§ Observers</a></p><p><a href="https://juejin.cn/post/6844904121833619469" target="_blank" rel="noreferrer">IntersectionObserver API åº”ç”¨æ€»ç»“</a></p><p><a href="https://blog.csdn.net/jiajia199470/article/details/109580507" target="_blank" rel="noreferrer">æ‡’åŠ è½½æ ¸å¿ƒå®ç°ä¹‹ intersectionobserver äº¤å‰è§‚å¯Ÿå™¨è¸©å‘</a></p><p><a href="https://www.zhangxinxu.com/wordpress/2019/08/js-dom-mutation-observer/" target="_blank" rel="noreferrer">èŠèŠ JS DOM å˜åŒ–çš„ç›‘å¬æ£€æµ‹ä¸åº”ç”¨</a></p></div>',97),m=[u];function A(E,h,g,v,f,C){return a(),n("div",null,m)}const k=s(B,[["render",A]]);export{O as __pageData,k as default};
